import{r as e,u as s,j as t,y as a,p as r,z as l,A as i,B as n,C as d,D as c,a as o,E as m,G as x,v as u,H as h,I as b,w as p,J as g,K as j,t as f,c as y,M as N,N as k,O as v,Q as w,b as _,R as S}from"./index-bGB9rp9t.js";import{S as C}from"./SubscriptionQRCode-DiDsB8Sr.js";import{m as D}from"./motion-DaFSZY4b.js";const A=()=>{const[A,E]=e.useState("account"),[I,F]=e.useState(!1),[P,M]=e.useState(!0),[U,W]=e.useState(null),[z,B]=e.useState(null),[G,T]=e.useState(null),[O,$]=e.useState([]),[H,L]=e.useState(!1),[R,q]=e.useState({}),[Y,V]=e.useState(!1),[Q,J]=e.useState(!1),[K,X]=e.useState(!1),[Z,ee]=e.useState({name:"",date:"",duration:"60",gymId:"",notes:""}),[se,te]=e.useState([]),[ae,re]=e.useState({workoutsThisMonth:0,totalHours:0,gymVisitsThisMonth:0,goalProgress:[],recentAchievements:[]}),le=s();e.useEffect(()=>{(async()=>{M(!0),W(null);try{const{user:e,error:s}=await u.getUser();if(s||!e)throw new Error(s?.message||"Not authenticated");let t;const{data:a,error:r}=await h.getById(e.id);if(r&&r.message.includes("No rows returned")){const s={user_id:e.id,first_name:e.user_metadata?.first_name||"",last_name:e.user_metadata?.last_name||"",avatar_url:e.user_metadata?.avatar_url||"https://images.pexels.com/photos/1181519/pexels-photo-1181519.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2",phone:"",address:"",fitness_goals:["Build Muscle","Improve Endurance"]},{data:a,error:r}=await h.create(s);if(r)throw new Error(r.message||"Failed to create profile");t=a[0]}else{if(r)throw new Error(r.message||"Failed to fetch profile data");t=a}const{data:l}=await b.getByUserId(e.id),i={...e,...t,name:`${t?.first_name||""} ${t?.last_name||""}`.trim()||e.email,avatar:t?.avatar_url||"https://images.pexels.com/photos/1181519/pexels-photo-1181519.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=2",memberSince:new Date(e.created_at).toLocaleDateString("en-US",{year:"numeric",month:"long"}),recentWorkouts:[],favoriteGyms:[]};try{const{data:s}=await p.getDetailedByUserId(e.id),t=(s||[]).map(e=>({id:e.gyms?.id||e.gym_id,name:e.gyms?.name||"",image:e.gyms?.image_url,location:e.gyms?.location||""}));i.favoriteGyms=t}catch{}if(T(i),q({first_name:t?.first_name||"",last_name:t?.last_name||"",phone:t?.phone||"",address:t?.address||"",fitness_goals:Array.isArray(t?.fitness_goals)?t.fitness_goals:t?.fitness_goals?[t.fitness_goals]:["Build Muscle","Improve Endurance"]}),l&&l.length>0){const e=l.map(e=>({...e,plan_name:e.subscription_plans?.name||"Unknown Plan",nextBillingDate:new Date(e.end_date).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),amount:"monthly"===e.billing_type?e.subscription_plans?.price_monthly:e.subscription_plans?.price_yearly,paymentHistory:[{date:e.start_date,amount:"monthly"===e.billing_type?e.subscription_plans?.price_monthly:e.subscription_plans?.price_yearly,status:"completed",method:"Credit Card ending in 4242"}]}));$(e)}}catch(e){W(e.message||"Failed to load profile data"),"Not authenticated"===e.message&&le("/login")}finally{M(!1)}})()},[le]),e.useEffect(()=>{(async()=>{if(G?.user_id)try{const{data:e,error:s}=await g.getByUserId(G.user_id);if(s)return void W("Failed to load workouts");const t=new Date,a=t.getMonth(),r=t.getFullYear(),l=e=>new Date(e.workout_date||e.date||e.created_at||t),i=(e||[]).filter(e=>{const s=l(e);return s.getMonth()===a&&s.getFullYear()===r}),n=i.length,d=+((e||[]).reduce((e,s)=>e+(Number(s.duration)||0),0)/60).toFixed(1),c=Array.isArray(G?.fitness_goals)?G.fitness_goals:G?.fitness_goals?[G.fitness_goals]:[],o=Math.min(100,Math.round(n/20*100)),m=c.map((e,s)=>({goal:e,percent:Math.min(100,Math.max(5,o+5*s))})),x=(e||[]).length,u=[];x>=10&&u.push({title:"10 Workouts Completed",date:i[0]?.workout_date||i[0]?.date||t}),d>=20&&u.push({title:"20 Total Hours",date:t}),re(e=>({...e,workoutsThisMonth:n,totalHours:d,goalProgress:m,recentAchievements:u})),T(s=>({...s,recentWorkouts:e&&e.length>0?e.map(e=>({id:e.id,date:e.workout_date||e.created_at||e.date,title:e.title||e.name,description:e.description||e.notes,duration:e.duration,gym:e.gyms?.name||e.gym,status:e.status})):[]}))}catch(e){W("Failed to load workouts")}})()},[G?.user_id,G?.fitness_goals]),e.useEffect(()=>{(async()=>{if(G?.user_id)try{const{data:e,error:s}=await j.getByUserId(G.user_id);if(s)return;const t=new Date,a=t.getMonth(),r=t.getFullYear(),l=(e||[]).filter(e=>{const s=new Date(e.scanned_at||e.created_at);return s.getMonth()===a&&s.getFullYear()===r}).length;re(e=>({...e,gymVisitsThisMonth:l}))}catch{}})()},[G?.user_id]),e.useEffect(()=>{(async()=>{try{const{data:e,error:s}=await f.getAll();s||te(e||[])}catch{}})()},[]);const ie=()=>{L(!H),W(null),B(null),H&&q({first_name:G?.first_name||"",last_name:G?.last_name||"",phone:G?.phone||"",address:G?.address||"",fitness_goals:Array.isArray(G?.fitness_goals)?G.fitness_goals:G?.fitness_goals?[G.fitness_goals]:["Build Muscle","Improve Endurance"]})},ne=async e=>{const s=e.target.files[0];if(s)if(s.type.startsWith("image/"))if(s.size>5242880)W("Image size must be less than 5MB");else{J(!0),W(null);try{const e=new FileReader;e.readAsDataURL(s),e.onload=async()=>{const s=e.result,{error:t}=await h.update(G.user_id,{avatar_url:s,updated_at:(new Date).toISOString()});if(t)throw new Error(t.message||"Failed to update avatar");T({...G,avatar:s,avatar_url:s}),B("Avatar updated successfully!"),setTimeout(()=>B(null),3e3)},e.onerror=()=>{throw new Error("Failed to read image file")}}catch(t){W(t.message||"Failed to upload avatar")}finally{J(!1)}}else W("Please select a valid image file")},de=[{id:"account",label:"Account",icon:t.jsx(y,{})},{id:"subscription",label:"Subscription",icon:t.jsx(N,{})},{id:"progress",label:"Progress",icon:t.jsx(k,{})},{id:"workouts",label:"Workouts",icon:t.jsx(v,{})},{id:"settings",label:"Settings",icon:t.jsx(w,{})}],ce=O.find(e=>"active"===e.status)||O[0],oe=ce?{membershipId:ce.membership_id,planName:ce.plan_name||"Standard",memberName:G?.name||"",validUntil:ce.end_date,planType:ce.billing_type,gymAccess:ce.subscription_plans?.gym_access_description||"500+ Gyms",price:ce.amount||49.99,verificationCode:ce.verification_code}:null,me=()=>{le("/plans")},xe=async()=>{if(ce)try{const{error:e}=await b.update(ce.id,{status:"cancelled",updated_at:(new Date).toISOString()});if(e)throw e;$(O.map(e=>e.id===ce.id?{...e,status:"cancelled"}:e)),B("Subscription cancelled successfully"),setTimeout(()=>B(null),3e3)}catch(e){W("Failed to cancel subscription. Please try again.")}},ue=async e=>{e.preventDefault(),M(!0);try{if(!Z.name||!Z.date||!Z.gymId)throw new Error("Please fill in all required fields");const e=parseInt(Z.duration,10);if(isNaN(e)||e<=0)throw new Error("Please enter a valid duration");const s={user_id:G.user_id,title:Z.name,workout_date:new Date(Z.date).toISOString(),duration:e,gym_id:Z.gymId||null,description:Z.notes||""},{data:t,error:a}=await g.create(s);if(a)throw a;T(e=>({...e,recentWorkouts:[t[0],...e.recentWorkouts]})),X(!1),ee({name:"",date:"",duration:"60",gymId:"",notes:""}),S.success("Workout scheduled successfully!")}catch(s){S.error(s.message||"Failed to schedule workout")}finally{M(!1)}};if(P)return t.jsx("div",{className:"min-h-screen py-16 flex items-center justify-center",children:t.jsxs("div",{className:"animate-pulse flex flex-col items-center",children:[t.jsx("div",{className:"w-32 h-32 bg-light-border dark:bg-dark-border rounded-full mb-4"}),t.jsx("div",{className:"h-6 bg-light-border dark:bg-dark-border rounded w-48 mb-2"}),t.jsx("div",{className:"h-4 bg-light-border dark:bg-dark-border rounded w-32"})]})});if(U&&!G)return t.jsx("div",{className:"min-h-screen py-16 flex items-center justify-center",children:t.jsxs("div",{className:"card p-8 max-w-md mx-auto text-center",children:[t.jsx("div",{className:"text-error-600 dark:text-error-400 text-5xl mb-4",children:"⚠️"}),t.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Error Loading Profile"}),t.jsx("p",{className:"text-light-textSecondary dark:text-dark-textSecondary mb-6",children:U}),t.jsx("button",{onClick:()=>le("/login"),className:"btn btn-primary",children:"Return to Login"})]})});if(!G)return null;return t.jsxs("div",{className:"min-h-screen py-16",children:[t.jsxs("div",{className:"container-custom",children:[(z||U)&&t.jsx(D.div,{className:"mb-6 p-4 rounded-lg "+(z?"bg-success-50 dark:bg-success-900/20 border border-success-200 dark:border-success-800 text-success-700 dark:text-success-400":"bg-error-50 dark:bg-error-900/20 border border-error-200 dark:border-error-800 text-error-700 dark:text-error-400"),initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},children:t.jsxs("div",{className:"flex items-center",children:[z?t.jsx(a,{className:"mr-2"}):t.jsx(r,{className:"mr-2"}),t.jsx("span",{children:z||U})]})}),t.jsxs("div",{className:"flex flex-col lg:flex-row gap-8",children:[t.jsx("div",{className:"lg:hidden card mb-6 p-6",children:t.jsxs("div",{className:"flex items-center",children:[t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"w-20 h-20 rounded-full overflow-hidden",children:t.jsx("img",{src:G.avatar,alt:G.name,className:"w-full h-full object-cover"})}),t.jsx("input",{type:"file",accept:"image/*",onChange:ne,className:"hidden",id:"avatar-upload-mobile"}),t.jsx("label",{htmlFor:"avatar-upload-mobile",className:"absolute bottom-0 right-0 bg-primary-600 text-white p-1.5 rounded-full cursor-pointer hover:bg-primary-700 transition-colors",children:Q?t.jsx("div",{className:"animate-spin w-3 h-3 border border-white border-t-transparent rounded-full"}):t.jsx(l,{size:14})})]}),t.jsxs("div",{className:"ml-4",children:[t.jsx("h1",{className:"text-2xl font-bold",children:G.name}),t.jsxs("p",{className:"text-light-textSecondary dark:text-dark-textSecondary",children:[ce?.plan_name||"No Active Plan"," Member"]})]})]})}),t.jsx("div",{className:"lg:w-1/4",children:t.jsxs("div",{className:"card sticky top-24",children:[t.jsxs("div",{className:"hidden lg:block mb-8",children:[t.jsx("div",{className:"flex justify-center",children:t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"w-24 h-24 rounded-full overflow-hidden mx-auto",children:t.jsx("img",{src:G.avatar,alt:G.name,className:"w-full h-full object-cover"})}),t.jsx("input",{type:"file",accept:"image/*",onChange:ne,className:"hidden",id:"avatar-upload-desktop"}),t.jsx("label",{htmlFor:"avatar-upload-desktop",className:"absolute bottom-0 right-0 bg-primary-600 text-white p-1.5 rounded-full cursor-pointer hover:bg-primary-700 transition-colors",children:Q?t.jsx("div",{className:"animate-spin w-3 h-3 border border-white border-t-transparent rounded-full"}):t.jsx(l,{size:14})})]})}),t.jsxs("div",{className:"text-center mt-4",children:[t.jsx("h1",{className:"text-2xl font-bold",children:G.name}),t.jsxs("p",{className:"text-light-textSecondary dark:text-dark-textSecondary",children:[ce?.plan_name||"No Active Plan"," Member"]}),t.jsxs("p",{className:"text-sm text-light-textSecondary dark:text-dark-textSecondary mt-1",children:["Member since ",G.memberSince]})]})]}),t.jsx("nav",{children:t.jsx("ul",{className:"space-y-1",children:de.map(e=>t.jsx("li",{children:t.jsxs("button",{className:"w-full flex items-center p-3 rounded-lg transition-colors "+(A===e.id?"bg-primary-100 dark:bg-primary-900/30 text-primary-700 dark:text-primary-400":"hover:bg-light-background dark:hover:bg-dark-background"),onClick:()=>E(e.id),children:[t.jsx("span",{className:"mr-3",children:e.icon}),t.jsx("span",{children:e.label})]})},e.id))})})]})}),t.jsx("div",{className:"lg:w-3/4",children:t.jsxs(D.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"card",children:["account"===A&&t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsx("h2",{className:"text-2xl font-bold",children:"Personal Information"}),t.jsxs("button",{className:"btn btn-outline flex items-center",onClick:ie,disabled:Y,children:[H?t.jsx(r,{className:"mr-2",size:16}):t.jsx(i,{className:"mr-2",size:16}),t.jsx("span",{children:H?"Cancel":"Edit"})]})]}),H?t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-2",children:"First Name *"}),t.jsx("input",{type:"text",className:"input w-full",value:R.first_name,onChange:e=>q({...R,first_name:e.target.value}),placeholder:"Enter your first name"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-2",children:"Last Name"}),t.jsx("input",{type:"text",className:"input w-full",value:R.last_name,onChange:e=>q({...R,last_name:e.target.value}),placeholder:"Enter your last name"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-2",children:"Phone Number"}),t.jsx("input",{type:"tel",className:"input w-full",value:R.phone,onChange:e=>q({...R,phone:e.target.value}),placeholder:"Enter your phone number"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-2",children:"Email Address"}),t.jsx("input",{type:"email",className:"input w-full",value:G.email,disabled:!0}),t.jsx("p",{className:"text-xs text-light-textSecondary dark:text-dark-textSecondary mt-1",children:"Email cannot be changed"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-2",children:"Address"}),t.jsx("textarea",{className:"input w-full h-20 resize-none",value:R.address,onChange:e=>q({...R,address:e.target.value}),placeholder:"Enter your address"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-2",children:"Fitness Goals"}),t.jsxs("div",{className:"space-y-2",children:[R.fitness_goals.map((e,s)=>t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"text",className:"input flex-1",value:e,onChange:e=>((e,s)=>{const t=[...R.fitness_goals];t[e]=s,q({...R,fitness_goals:t})})(s,e.target.value),placeholder:"Enter fitness goal"}),t.jsx("button",{type:"button",className:"btn btn-outline p-2 text-error-600 dark:text-error-400 hover:bg-error-50 dark:hover:bg-error-900/20",onClick:()=>(e=>{q({...R,fitness_goals:R.fitness_goals.filter((s,t)=>t!==e)})})(s),children:t.jsx(n,{size:16})})]},s)),t.jsxs("button",{type:"button",className:"btn btn-outline flex items-center",onClick:()=>{q({...R,fitness_goals:[...R.fitness_goals,""]})},children:[t.jsx(d,{className:"mr-2",size:16}),"Add Goal"]})]})]}),t.jsxs("div",{className:"flex gap-3",children:[t.jsxs("button",{className:"btn btn-primary flex items-center",onClick:async()=>{V(!0),W(null),B(null);try{if(!R.first_name.trim())throw new Error("First name is required");const e=R.fitness_goals.filter(e=>""!==e.trim()),s={...R,fitness_goals:e,updated_at:(new Date).toISOString()},{error:t}=await h.update(G.user_id,s);if(t)throw new Error(t.message||"Failed to update profile");T({...G,...s,name:`${R.first_name} ${R.last_name}`.trim()}),L(!1),B("Profile updated successfully!"),setTimeout(()=>B(null),3e3)}catch(e){W(e.message||"Failed to update profile")}finally{V(!1)}},disabled:Y,children:[t.jsx(c,{className:"mr-2",size:16}),t.jsx("span",{children:Y?"Saving...":"Save Changes"})]}),t.jsx("button",{className:"btn btn-outline",onClick:ie,disabled:Y,children:"Cancel"})]})]}):t.jsxs("div",{children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-sm text-light-textSecondary dark:text-dark-textSecondary mb-1",children:"Full Name"}),t.jsx("p",{className:"font-medium",children:G.name||"Not provided"})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-sm text-light-textSecondary dark:text-dark-textSecondary mb-1",children:"Email Address"}),t.jsx("p",{className:"font-medium",children:G.email})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-sm text-light-textSecondary dark:text-dark-textSecondary mb-1",children:"Phone Number"}),t.jsx("p",{className:"font-medium",children:G.phone||"Not provided"})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-sm text-light-textSecondary dark:text-dark-textSecondary mb-1",children:"Address"}),t.jsx("p",{className:"font-medium",children:G.address||"Not provided"})]})]}),t.jsx("hr",{className:"my-8 border-light-border dark:border-dark-border"}),t.jsxs("div",{className:"mb-6",children:[t.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Fitness Goals"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:G.fitness_goals?.length>0?G.fitness_goals.map((e,s)=>t.jsx("span",{className:"bg-light-background dark:bg-dark-background px-3 py-1 rounded-full text-sm",children:e},s)):t.jsx("p",{className:"text-light-textSecondary dark:text-dark-textSecondary",children:"No fitness goals set yet"})})]}),t.jsx("hr",{className:"my-8 border-light-border dark:border-dark-border"}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Favorite Gyms"}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:G.favoriteGyms.map(e=>t.jsxs("div",{className:"flex bg-light-background dark:bg-dark-background rounded-lg overflow-hidden",children:[t.jsx("div",{className:"w-20 h-20 flex-shrink-0",children:t.jsx("img",{src:e.image,alt:e.name,className:"w-full h-full object-cover"})}),t.jsxs("div",{className:"p-3",children:[t.jsx("h3",{className:"font-medium",children:e.name}),t.jsxs("p",{className:"text-sm text-light-textSecondary dark:text-dark-textSecondary flex items-center",children:[t.jsx(o,{size:12,className:"mr-1"}),e.location]})]})]},e.id))})]})]})]}),"subscription"===A&&t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Subscription Details"}),O.length>0?t.jsxs("div",{className:"space-y-6",children:[O.map(e=>t.jsxs("div",{className:"bg-light-background dark:bg-dark-background p-6 rounded-lg",children:[t.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between mb-4",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-light-textSecondary dark:text-dark-textSecondary mb-1 block",children:"active"===e.status?"Current Plan":"Previous Plan"}),t.jsx("h3",{className:"text-2xl font-bold text-primary-600 dark:text-primary-500",children:e.plan_name}),t.jsxs("p",{className:"text-sm text-light-textSecondary dark:text-dark-textSecondary",children:[e.billing_type," billing • $",e.amount,"/","monthly"===e.billing_type?"month":"year"]})]}),t.jsxs("div",{className:"flex flex-col items-start md:items-end mt-4 md:mt-0",children:[t.jsx("span",{className:"px-3 py-1 rounded-full text-sm font-medium "+("active"===e.status?"bg-success-100 dark:bg-success-900/20 text-success-700 dark:text-success-400":"bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-400"),children:e.status.charAt(0).toUpperCase()+e.status.slice(1)}),"active"===e.status&&t.jsxs("span",{className:"text-sm text-light-textSecondary dark:text-dark-textSecondary mt-1",children:["Next billing: ",e.nextBillingDate]})]})]}),"active"===e.status&&t.jsxs("div",{className:"flex flex-col sm:flex-row flex-wrap gap-3 mb-4",children:[t.jsxs("button",{className:"btn btn-primary flex items-center justify-center flex-1 min-w-0",onClick:()=>F(!0),children:[t.jsx(m,{className:"mr-2",size:16}),"Show QR Code"]}),t.jsx("button",{className:"btn btn-outline flex items-center justify-center flex-1 min-w-0",onClick:me,children:"Upgrade Plan"}),t.jsx("button",{className:"btn btn-outline text-error-600 dark:text-error-400 border-error-200 dark:border-error-800 hover:bg-error-50 dark:hover:bg-error-900/20 flex items-center justify-center flex-1 min-w-0",onClick:xe,children:"Cancel Subscription"})]}),t.jsxs("div",{className:"mt-6",children:[t.jsx("h4",{className:"font-semibold mb-3",children:"Payment History"}),t.jsx("div",{className:"space-y-2",children:e.paymentHistory?.map((s,a)=>t.jsxs("div",{className:"flex items-center justify-between p-3 bg-white dark:bg-dark-card rounded-lg",children:[t.jsxs("div",{children:[t.jsxs("p",{className:"font-medium",children:["$",s.amount," -"," ",e.plan_name]}),t.jsxs("p",{className:"text-sm text-light-textSecondary dark:text-dark-textSecondary",children:[new Date(s.date).toLocaleDateString()," ","• ",s.method]})]}),t.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium "+("completed"===s.status?"bg-success-100 dark:bg-success-900/20 text-success-700 dark:text-success-400":"bg-error-100 dark:bg-error-900/20 text-error-700 dark:text-error-400"),children:s.status})]},a))})]})]},e.id)),ce&&t.jsxs("div",{className:"mt-8",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Plan Benefits"}),t.jsxs("ul",{className:"space-y-3",children:[t.jsxs("li",{className:"flex items-start",children:[t.jsx(a,{className:"text-success-500 mt-1 mr-2 flex-shrink-0"}),t.jsxs("span",{children:["Access to"," ",ce.subscription_plans?.gym_access_description||"500+ gyms"," ","nationwide"]})]}),t.jsxs("li",{className:"flex items-start",children:[t.jsx(a,{className:"text-success-500 mt-1 mr-2 flex-shrink-0"}),t.jsx("span",{children:"24/7 gym access at all locations"})]}),t.jsxs("li",{className:"flex items-start",children:[t.jsx(a,{className:"text-success-500 mt-1 mr-2 flex-shrink-0"}),t.jsx("span",{children:"Premium workout plans and tracking tools"})]}),t.jsxs("li",{className:"flex items-start",children:[t.jsx(a,{className:"text-success-500 mt-1 mr-2 flex-shrink-0"}),t.jsx("span",{children:"Advanced health tracking and metrics"})]}),t.jsxs("li",{className:"flex items-start",children:[t.jsx(a,{className:"text-success-500 mt-1 mr-2 flex-shrink-0"}),t.jsx("span",{children:"Digital membership with QR code access"})]})]})]})]}):t.jsxs("div",{className:"text-center py-12",children:[t.jsx("div",{className:"text-6xl mb-4",children:"💳"}),t.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No Active Subscription"}),t.jsx("p",{className:"text-light-textSecondary dark:text-dark-textSecondary mb-6",children:"You don't have any active subscriptions. Choose a plan to get started!"}),t.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[t.jsx("button",{className:"btn btn-primary flex items-center justify-center",onClick:()=>le("/plans"),children:"View Plans"}),t.jsx("button",{className:"btn btn-outline flex items-center justify-center",onClick:()=>(async e=>{try{const{data:s,error:t}=await b.getByUserId(G.user_id);if(t)throw new Error("Failed to check existing subscriptions");const a=s?.some(e=>"active"===e.status);if(a)return void W("You already have an active subscription. Please cancel your current subscription before subscribing to a new plan.");const r=`MEM${Date.now()}${Math.floor(1e3*Math.random())}`,l=Math.random().toString(36).substring(2,8).toUpperCase(),{error:i}=await b.create({user_id:G.user_id,plan_id:e,membership_id:r,status:"active",billing_type:"monthly",start_date:(new Date).toISOString(),end_date:new Date(Date.now()+2592e6).toISOString(),verification_code:l,gym_id:null,price:49.99,qr_code_data:JSON.stringify({membershipId:r,verificationCode:l,userId:G.user_id,planId:e,startDate:(new Date).toISOString(),endDate:new Date(Date.now()+2592e6).toISOString()})});if(i)throw new Error(i.message||"Failed to create subscription");B("Successfully subscribed to the plan!");const{data:n}=await b.getByUserId(G.user_id);$(n)}catch(s){W(s.message||"Failed to subscribe to plan")}})("standard-plan"),children:"Subscribe Now"})]})]})]}),"workouts"===A&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("h3",{className:"text-lg font-semibold",children:"Recent Workouts"}),t.jsxs("button",{className:"btn btn-primary",onClick:()=>X(!0),children:[t.jsx(d,{className:"mr-2"}),"Schedule Workout"]})]}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b border-light-border dark:border-dark-border",children:[t.jsx("th",{className:"text-left py-3 px-4",children:"Workout"}),t.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),t.jsx("th",{className:"text-left py-3 px-4",children:"Duration"}),t.jsx("th",{className:"text-left py-3 px-4",children:"Gym"}),t.jsx("th",{className:"text-left py-3 px-4",children:"Status"})]})}),t.jsx("tbody",{children:G.recentWorkouts?.map(e=>t.jsxs("tr",{className:"border-b border-light-border dark:border-dark-border hover:bg-light-hover dark:hover:bg-dark-hover",children:[t.jsx("td",{className:"py-3 px-4",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 rounded-full bg-primary-100 dark:bg-primary-900 flex items-center justify-center",children:t.jsx(_,{className:"text-primary-600 dark:text-primary-500"})}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium",children:e.title||e.name||"Unnamed Workout"}),t.jsx("p",{className:"text-sm text-light-textSecondary dark:text-dark-textSecondary",children:e.description||e.notes||"No notes"})]})]})}),t.jsx("td",{className:"py-3 px-4",children:e.workout_date||e.date?new Date(e.workout_date||e.date).toLocaleDateString():"No date"}),t.jsxs("td",{className:"py-3 px-4",children:[e.duration||"0"," minutes"]}),t.jsx("td",{className:"py-3 px-4",children:e.gyms?.name||e.gym||"No gym specified"}),t.jsx("td",{className:"py-3 px-4",children:t.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium "+(e.status,"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200"),children:e.status?e.status.charAt(0).toUpperCase()+e.status.slice(1):"completed"})})]},e.id))})]})}),K&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-light-background dark:bg-dark-background rounded-lg p-6 w-full max-w-md",children:[t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold",children:"Schedule Workout"}),t.jsx("button",{className:"btn btn-ghost btn-sm",onClick:()=>X(!1),children:t.jsx(r,{})})]}),t.jsxs("form",{onSubmit:ue,className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Workout Name"}),t.jsx("input",{type:"text",className:"input w-full",value:Z.name,onChange:e=>ee({...Z,name:e.target.value}),required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Date"}),t.jsx("input",{type:"datetime-local",className:"input w-full",value:Z.date,onChange:e=>ee({...Z,date:e.target.value}),required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Duration (minutes)"}),t.jsx("input",{type:"number",className:"input w-full",value:Z.duration,onChange:e=>ee({...Z,duration:e.target.value||"60"}),min:"1",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Gym"}),t.jsxs("select",{className:"input w-full",value:Z.gymId,onChange:e=>ee({...Z,gymId:e.target.value}),required:!0,children:[t.jsx("option",{value:"",disabled:!0,children:"Select a gym"}),se.map(e=>t.jsxs("option",{value:e.id,children:[e.name,e.city?` — ${e.city}`:""]},e.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Notes"}),t.jsx("textarea",{className:"input w-full",value:Z.notes,onChange:e=>ee({...Z,notes:e.target.value}),rows:3})]}),t.jsxs("div",{className:"flex justify-end gap-2",children:[t.jsx("button",{type:"button",className:"btn btn-ghost",onClick:()=>X(!1),children:"Cancel"}),t.jsx("button",{type:"submit",className:"btn btn-primary",children:"Schedule"})]})]})]})})]}),"progress"===A&&t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Your Progress"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-8",children:[t.jsxs("div",{className:"card bg-primary-50 dark:bg-primary-900/20 p-6",children:[t.jsx("p",{className:"text-sm text-primary-600 dark:text-primary-400 mb-1",children:"Workouts This Month"}),t.jsx("h3",{className:"text-3xl font-bold text-primary-700 dark:text-primary-500",children:ae.workoutsThisMonth}),t.jsx("p",{className:"text-sm text-primary-600/70 dark:text-primary-400/70 mt-1",children:" "})]}),t.jsxs("div",{className:"card bg-secondary-50 dark:bg-secondary-900/20 p-6",children:[t.jsx("p",{className:"text-sm text-secondary-600 dark:text-secondary-400 mb-1",children:"Total Hours"}),t.jsx("h3",{className:"text-3xl font-bold text-secondary-700 dark:text-secondary-500",children:ae.totalHours}),t.jsx("p",{className:"text-sm text-secondary-600/70 dark:text-secondary-400/70 mt-1",children:" "})]}),t.jsxs("div",{className:"card bg-accent-50 dark:bg-accent-900/20 p-6",children:[t.jsx("p",{className:"text-sm text-accent-600 dark:text-accent-400 mb-1",children:"Gym Visits"}),t.jsx("h3",{className:"text-3xl font-bold text-accent-700 dark:text-accent-500",children:ae.gymVisitsThisMonth}),t.jsx("p",{className:"text-sm text-accent-600/70 dark:text-accent-400/70 mt-1",children:" "})]})]}),t.jsxs("div",{className:"mb-8",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Goal Progress"}),t.jsx("div",{className:"space-y-6",children:ae.goalProgress.map((e,s)=>t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between mb-2",children:[t.jsx("span",{className:"font-medium",children:e.goal}),t.jsxs("span",{children:[e.percent,"%"]})]}),t.jsx("div",{className:"w-full bg-light-background dark:bg-dark-background rounded-full h-2.5",children:t.jsx("div",{className:"bg-primary-600 h-2.5 rounded-full",style:{width:`${e.percent}%`}})})]},s))})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Recent Achievements"}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:0===ae.recentAchievements.length?t.jsx("div",{className:"text-light-textSecondary dark:text-dark-textSecondary",children:"No achievements yet"}):ae.recentAchievements.map((e,s)=>t.jsxs("div",{className:"flex bg-light-background dark:bg-dark-background p-4 rounded-lg",children:[t.jsx("div",{className:"bg-primary-100 dark:bg-primary-900/30 text-primary-600 dark:text-primary-400 p-3 rounded-full mr-4",children:t.jsx(a,{size:24})}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium",children:e.title}),t.jsx("p",{className:"text-sm text-light-textSecondary dark:text-dark-textSecondary",children:e.date?new Date(e.date).toLocaleDateString():""})]})]},s))})]})]}),"settings"===A&&t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Account Settings"}),t.jsxs("div",{className:"space-y-8",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Email Notifications"}),t.jsx("div",{className:"space-y-3",children:[{id:"workout-reminders",label:"Workout reminders"},{id:"subscription-updates",label:"Subscription updates"},{id:"new-features",label:"New features and improvements"},{id:"gym-updates",label:"Updates from your favorite gyms"},{id:"promotional",label:"Promotional emails and special offers"}].map(e=>t.jsxs("div",{className:"flex items-center justify-between p-3 bg-light-background dark:bg-dark-background rounded-lg",children:[t.jsx("label",{htmlFor:e.id,className:"cursor-pointer",children:e.label}),t.jsxs("div",{className:"relative inline-block w-12 h-6 transition duration-200 ease-in-out rounded-full cursor-pointer",children:[t.jsx("input",{type:"checkbox",id:e.id,className:"absolute w-6 h-6 transition duration-200 ease-in-out transform bg-white border-2 rounded-full appearance-none cursor-pointer peer border-light-border dark:border-dark-border checked:translate-x-6 checked:border-primary-600 dark:checked:border-primary-500",defaultChecked:["workout-reminders","subscription-updates","new-features"].includes(e.id)}),t.jsx("span",{className:"absolute inset-0 transition duration-200 ease-in-out rounded-full bg-light-border dark:bg-dark-border peer-checked:bg-primary-600 dark:peer-checked:bg-primary-500"})]})]},e.id))})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Privacy Settings"}),t.jsx("div",{className:"space-y-3",children:[{id:"show-profile",label:"Show my profile to other members"},{id:"share-workouts",label:"Share my workouts with friends"},{id:"location-tracking",label:"Enable location tracking for gym suggestions"}].map(e=>t.jsxs("div",{className:"flex items-center justify-between p-3 bg-light-background dark:bg-dark-background rounded-lg",children:[t.jsx("label",{htmlFor:e.id,className:"cursor-pointer",children:e.label}),t.jsxs("div",{className:"relative inline-block w-12 h-6 transition duration-200 ease-in-out rounded-full cursor-pointer",children:[t.jsx("input",{type:"checkbox",id:e.id,className:"absolute w-6 h-6 transition duration-200 ease-in-out transform bg-white border-2 rounded-full appearance-none cursor-pointer peer border-light-border dark:border-dark-border checked:translate-x-6 checked:border-primary-600 dark:checked:border-primary-500",defaultChecked:["location-tracking"].includes(e.id)}),t.jsx("span",{className:"absolute inset-0 transition duration-200 ease-in-out rounded-full bg-light-border dark:bg-dark-border peer-checked:bg-primary-600 dark:peer-checked:bg-primary-500"})]})]},e.id))})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Account Actions"}),t.jsxs("div",{className:"space-y-3",children:[t.jsx("button",{className:"w-full btn btn-outline justify-start",children:"Change Password"}),t.jsxs("button",{onClick:async()=>{try{await u.signOut(),le("/login")}catch(e){}},className:"w-full btn btn-outline justify-start",children:[t.jsx(x,{className:"mr-2"})," Sign Out"]}),t.jsx("button",{className:"w-full btn btn-outline justify-start text-error-600 dark:text-error-400 border-error-200 dark:border-error-800 hover:bg-error-50 dark:hover:bg-error-900/20",children:"Delete Account"})]})]})]})]})]},A)})]})]}),I&&oe&&t.jsx(C,{subscriptionData:oe,onClose:()=>F(!1)})]})};export{A as default};
